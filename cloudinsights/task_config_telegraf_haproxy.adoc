---
sidebar: sidebar 
permalink: task_config_telegraf_haproxy.html 
keywords: telegraf, installation, install, haproxy 
summary: Configuración del recopilador de datos de HAProxy 
---
= Recopilador de datos de HAProxy
:hardbreaks:
:toclevels: 1
:allow-uri-read: 
:toclevels: 1
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
Cloud Insights utiliza este recopilador de datos para recopilar métricas de HAProxy.



== Instalación

. En *Observabilidad > Colectores*, haz clic en *+Recopilador de datos*. Seleccione HAProxy.
+
Seleccione el sistema operativo o la plataforma en la que está instalado el agente Telegraf.

. Si todavía no ha instalado un agente para la colección o desea instalar un agente para un sistema operativo o plataforma diferente, haga clic en _Mostrar instrucciones_ para expandir el link:task_config_telegraf_agent.html["Instalación del agente"] instrucciones.
. Seleccione la clave de acceso del agente para utilizarla con este recopilador de datos. Puede agregar una nueva clave de acceso del agente haciendo clic en el botón *+ clave de acceso del agente*. Práctica recomendada: Utilice una clave de acceso de agente diferente sólo cuando desee agrupar recopiladores de datos, por ejemplo, por sistema operativo/plataforma.
. Siga los pasos de configuración para configurar el recopilador de datos. Las instrucciones varían en función del tipo de sistema operativo o plataforma que utilice para recopilar datos.


image:HAProxyDCConfigLinux.png["Configuración de HAProxy"]



== Configuración

El complemento de Telegraf para HAProxy se basa en la habilitación de HAProxy Stats. Se trata de una configuración integrada en HAProxy pero no está activada de forma inmediata. Cuando se habilita, HAProxy expondrá un punto final HTML que se puede ver en el explorador o se puede raspar para extraer el estado de todas las configuraciones de HAProxy.



=== Compatibilidad:

La configuración se desarrolló contra HAProxy versión 1.9.4.



=== Configuración:

Para habilitar las estadísticas, edite el archivo de configuración de haproxy y agregue las siguientes líneas después de la sección 'valores predeterminados', utilizando su propia contraseña/usuario y/o URL de haproxy:

[listing]
----
stats enable
stats auth myuser:mypassword
stats uri  /haproxy?stats
----
A continuación se muestra un ejemplo de archivo de configuración simplificado con estadísticas habilitadas:

[listing]
----
global
  daemon
  maxconn 256

defaults
  mode http
  stats enable
  stats uri /haproxy?stats
  stats auth myuser:mypassword
  timeout connect 5000ms
  timeout client 50000ms
  timeout server 50000ms

frontend http-in
  bind *:80
  default_backend servers

frontend http-in9080
  bind *:9080
  default_backend servers_2

backend servers
  server server1 10.128.0.55:8080 check ssl verify none
  server server2 10.128.0.56:8080 check ssl verify none

backend servers_2
  server server3 10.128.0.57:8080 check ssl verify none
  server server4 10.128.0.58:8080 check ssl verify none
----
Para obtener instrucciones completas y actualizadas, consulte link:https://cbonte.github.io/haproxy-dconv/1.8/configuration.html#4-stats%20enable["Documentación de HAProxy"].



== Objetos y contadores

Se recopilan los objetos siguientes y sus contadores:

[cols="<.<,<.<,<.<,<.<"]
|===
| Objeto: | Identificadores: | Atributos: | Puntos de datos: 


| Interfaz HAProxy | Espacio de nombres
Dirección
Proxy | IP del nodo
Nombre del nodo
ID de proxy
Modo
ID de proceso
Límite de Tasa de Sesiones
ID de servidor
Límite de sesiones
Estado | Bytes en
Bytes de salida
Aciertos en caché
Valores de Lista de Caché
Bytes de compresión omitidos
Compresión de bytes en
Bytes de compresión fuera
Respuestas de compresión
Velocidad de conexión
Velocidad de conexión máxima
Total de Conexiones
Solicitudes denegadas por regla de conexión
Solicitudes denegadas por problemas de seguridad
Respuestas denegadas por preocupaciones de seguridad
Solicitudes denegadas por regla de sesión
Errores de Solicitudes
Respuestas 1xx
Respuestas 2xx
Respuestas 3xx
Respuestas 4xx
Respuestas 5xx
Respuestas a otros
Solicitudes interceptadas
Ratio de Sesiones
Ratio Máximo de Sesiones
Ratio de Solicitudes
Ratio Máximo de Solicitudes
Total de solicitudes
Sesiones
Máximo de Sesiones
Total de Sesiones
Solicita reescrituras 


| Servidor HAProxy | Espacio de nombres
Dirección
Proxy
Servidor | IP del nodo
Nombre del nodo
Compruebe la hora para finalizar
Compruebe la configuración de caída
Compruebe el valor de estado
Compruebe la configuración de RISE
Comprobar estado
ID de proxy
Hora del último cambio
Hora de la última sesión
Modo
ID de proceso
ID de servidor
Estado
Peso | Servidores activos
Servidores de backup
Bytes en
Bytes de salida
Comprobar Desconexiones
Error en la comprobación
El cliente aborta
Conexiones
Tiempo medio de conexión
Tiempo de inactividad total
Respuestas denegadas
Errores de conexión
Errores de respuesta
Respuestas 1xx
Respuestas 2xx
Respuestas 3xx
Respuestas 4xx
Respuestas 5xx
Respuestas a otros
Total de Servidor Seleccionado
Cola actual
Máximo de cola
Tiempo medio de cola
Sesiones por segundo
Máximo de Sesiones por Segundo
Reutilización de la conexión
Tiempo de respuesta medio
Sesiones
Máximo de Sesiones
La transferencia de servidor se cancela
Total de Sesiones
Promedio de Tiempo Total de Sesiones
Solicita mensajes reenviados
Solicita reintentos
Solicita reescrituras 


| Backend de HAProxy | Espacio de nombres
Dirección
Proxy | IP del nodo
Nombre del nodo
ID de proxy
Hora del último cambio
Hora de la última sesión
Modo
ID de proceso
ID de servidor
Límite de sesiones
Estado
Peso | Servidores activos
Servidores de backup
Bytes en
Bytes de salida
Aciertos en caché
Valores de Lista de Caché
Comprobar Desconexiones
El cliente aborta
Bytes de compresión omitidos
Compresión de bytes en
Bytes de compresión fuera
Respuestas de compresión
Conexiones
Tiempo medio de conexión
Tiempo de inactividad total
Solicitudes denegadas por problemas de seguridad
Respuestas denegadas por preocupaciones de seguridad
Errores de conexión
Errores de respuesta
Respuestas 1xx
Respuestas 2xx
Respuestas 3xx
Respuestas 4xx
Respuestas 5xx
Respuestas a otros
Total de Servidor Seleccionado
Cola actual
Máximo de cola
Tiempo medio de cola
Sesiones por segundo
Máximo de Sesiones por Segundo
Total de solicitudes
Reutilización de la conexión
Tiempo de respuesta medio
Sesiones
Máximo de Sesiones
La transferencia de servidor se cancela
Total de Sesiones
Promedio de Tiempo Total de Sesiones
Solicita mensajes reenviados
Solicita reintentos
Solicita reescrituras 
|===


== Resolución de problemas

Puede encontrar información adicional en link:concept_requesting_support.html["Soporte técnico"] página.
