---
sidebar: sidebar 
permalink: task_config_telegraf_kafka.html 
keywords: telegraf, installation, install, kafka 
summary: Configuración de recopilador de datos Kafka 
---
= Recopilador de datos Kafka
:hardbreaks:
:toclevels: 1
:allow-uri-read: 
:toclevels: 1
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
Cloud Insights utiliza este recopilador de datos para recopilar métricas de Kafka.



== Instalación

. En *Observabilidad > Colectores*, haz clic en *+Recopilador de datos*. Elige Kafka.
+
Seleccione el sistema operativo o la plataforma en la que está instalado el agente Telegraf.

. Si todavía no ha instalado un agente para la colección o desea instalar un agente para un sistema operativo o plataforma diferente, haga clic en _Mostrar instrucciones_ para expandir el link:task_config_telegraf_agent.html["Instalación del agente"] instrucciones.
. Seleccione la clave de acceso del agente para utilizarla con este recopilador de datos. Puede agregar una nueva clave de acceso del agente haciendo clic en el botón *+ clave de acceso del agente*. Práctica recomendada: Utilice una clave de acceso de agente diferente sólo cuando desee agrupar recopiladores de datos, por ejemplo, por sistema operativo/plataforma.
. Siga los pasos de configuración para configurar el recopilador de datos. Las instrucciones varían en función del tipo de sistema operativo o plataforma que utilice para recopilar datos.


image:KafkaDCConfigWindows.png["Configuración de Kafka"]



== Configuración

El complemento Kafka se basa en el complemento Jolokia de telegraf. Como un requisito para recopilar información de todos los corredores Kafka, JMX debe configurarse y exponerse a través de Jolokia en todos los componentes.



=== Compatibilidad

La configuración se desarrolló contra Kafka versión 0.11.0.2.



=== Configuración

Todas las instrucciones a continuación suponen que su ubicación de instalación para kafka es '/opt/kafka'. Puede adaptar las instrucciones siguientes para reflejar la ubicación de la instalación.



==== Agente Jolokia Jar

Una versión el archivo JAR del agente JAR de Jolokia debe ser link:https://jolokia.org/download.html["descargado"]. La versión probada en contra fue el agente Jolokia 1.6.0.

Las instrucciones siguientes asumen que el archivo JAR descargado (jolokia-jvm-1.6.0-agent.jar) se coloca bajo la ubicación '/opt/kafka/libs/'.



==== Kafka Brokers

Para configurar Kafka Brokers para exponer la API de Jolokia, puede agregar lo siguiente en <KAFKA_HOME>/bin/kafka-Server-start.sh, justo antes de la llamada 'kafka-run-class.sh':

[listing]
----
export JMX_PORT=9999
export RMI_HOSTNAME=`hostname -I`
export KAFKA_JMX_OPTS="-javaagent:/opt/kafka/libs/jolokia-jvm-1.6.0-agent.jar=port=8778,host=0.0.0.0  -Dcom.sun.management.jmxremote.password.file=/opt/kafka/config/jmxremote.password -Dcom.sun.management.jmxremote.ssl=false -Djava.rmi.server.hostname=$RMI_HOSTNAME -Dcom.sun.management.jmxremote.rmi.port=$JMX_PORT"
----
Tenga en cuenta que el ejemplo anterior utiliza 'hostname -i' para configurar la variable de entorno 'RMI_HOSTNAME'. En múltiples equipos IP, esto tendrá que ser ajustado para reunir la IP que usted cuida para las conexiones RMI.

Puede elegir un puerto diferente para JMX (9999 arriba) y Jolokia (8778). Si usted tiene un IP interno para bloquear Jolokia en usted puede reemplazar el "Catch all" 0.0.0.0 por su propio IP. Tenga en cuenta que este IP debe ser accesible desde el plugin de telegraf. Puede utilizar la opción '-Dcom.sun.management.jmxremote.authenticate=false' si no desea autenticar. Uso bajo su propio riesgo.



== Objetos y contadores

Se recopilan los objetos siguientes y sus contadores:

[cols="<.<,<.<,<.<,<.<"]
|===
| Objeto: | Identificadores: | Atributos: | Puntos de datos: 


| Kafka Broker | Clúster
Espacio de nombres
Agente | Nombre del nodo
IP del nodo | Retraso máximo de recuperación del gestor de réplicas
ZooKeeper Conexiones de cliente
ZooKeeper Client Connections (tarifa de 15m)
ZooKeeper Client Connections (tarifa de 5m)
ZooKeeper Client Connections (tasa media)
ZooKeeper Client Connections (tarifa de 1m)
Recuento de particiones de gestor de réplicas
Daemon de recuento de threads
Pico de recuento de threads
Recuento de Threads Actual
Recuento de Threads Total Iniciado
Particiones fuera de línea
Tiempo total de solicitudes de producción (percentil 50th)
Tiempo total de solicitudes de producción (percentil 75th)
Tiempo total de solicitudes de producción (percentil 95th)
Tiempo total de solicitudes de producción (percentil 98)
Tiempo total de solicitudes de producción (percentil 999th)
Tiempo total de solicitudes de producción (percentil 99th)
Tiempo Total de Solicitudes de Producción
Tiempo Máximo Total de Solicitudes de Producción
Media de Tiempo Total de Solicitudes de Producción
Tiempo Total Mínimo de Reproducción de Solicitudes
Tiempo Total de Solicitudes de Producción STDDEV
El gestor de réplicas ISR se reduce
Replica Manager ISR encoge (tarifa de 15m)
Replica Manager ISR encoge (tarifa de 5m)
Reducción ISR del gestor de réplicas (tasa media)
Replica Manager ISR encoge (tarifa de 1m)
Media de Inactividad del Manejador de Solicitudes
Manejador de solicitudes en ralentí medio (tarifa de 15m)
Manejador de solicitudes en ralentí medio (tarifa de 5m)
Media de Inactividad del Manejador de Solicitudes (Tasa Media)
Manejador de solicitudes en ralentí medio (tarifa de 1m)
Recuento de generaciones anteriores de recolección de basura G1
Recolección de Basura G1 Tiempo de Generación Antigua
Recolección de Basura G1 Young Generation Count
Recolección de Basura G1 Tiempo de Generación Joven
ZooKeeper solo se conecta
ZooKeeper Sólo Lectura Conexiones (tarifa de 15m)
ZooKeeper Sólo Lectura Conexiones (tarifa de 5m)
ZooKeeper solo conexiones de lectura (tasa media)
ZooKeeper Sólo Lectura Conexiones (tarifa de 1m)
Tiempo medio inactivo del procesador de red
Solicitudes Fetch Follower Tiempo total (50th percentil)
Solicitudes Fetch Follower Tiempo total (75th percentil)
Solicitudes Fetch Follower Tiempo total (95th percentil)
Solicitudes Fetch Follower Tiempo total (98th percentil)
Solicitudes Fetch Follower Tiempo total (999th percentil)
Solicitudes Fetch Follower Tiempo total (99th percentil)
Tiempo Total de Recuperación de Seguidor de Solicitudes
Máximo de tiempo total de recuperación de seguidor de solicitudes
Media de tiempo total de recuperación de seguidor de solicitudes
Tiempo Total Mínimo de Recuperación de Seguidor de Solicitudes
Solicitudes de Recuperación de Tiempo Total de Seguidor STDDEV
Solicitudes en espera en Produce Purgatory
Solicitudes de red Recuperar consumidor
Solicitud de red: Fetch Consumer (tarifa de 5m $)
Solicitud de red: Fetch Consumer (tarifa de 15m $)
Solicitud de red: Recuperar consumidor (tasa media)
Solicitud de red: Fetch Consumer (tarifa de 1m $)
Elecciones de líderes impuros
Elecciones de líderes impuros (tasa de 15m)
Elecciones de líderes impuros (tasa de 5m)
Elecciones de líderes impuros (tasa media)
Elecciones de líderes impuros (tasa de 1m)
Controladoras activas
Memoria de pila confirmada
Inicialización de Memoria de Pila
Memoria de Pila Máx
Memoria de Pila Usada
La sesión de ZooKeeper caduca
ZooKeeper Sesión Expira (15m tarifa)
ZooKeeper Sesión Expira (5m tarifa)
La sesión de ZooKeeper caduca (tasa media)
ZooKeeper Sesión Expira (1m tarifa)
Fallos de autenticación de ZooKeeper
Fallos de autenticación de ZooKeeper (tasa de 15m)
Fallos de autenticación de ZooKeeper (tasa de 5m)
Fallos de autenticación de ZooKeeper (tasa media)
Fallos de autenticación de ZooKeeper (tasa de 1m)
Tiempo de elección de líder (percentil 50th)
Tiempo de elección de líder (percentil 75th)
Tiempo de elección de líder (percentil 95th)
Tiempo de elección de líder (percentil 98th)
Tiempo de elección de líder (percentil 999th)
Tiempo de elección de líder (percentil 99th)
Recuento de Elecciones de Líderes
Tiempo de elección de líder (tasa de 15m)
Tiempo de elección de líder (tasa de 5m)
Tiempo máximo de elección de líder
Tiempo de elección de líder medio
Tiempo de elección de líder (tasa media)
Tiempo Mínimo de Elección de Líder
Tiempo de elección de líder (tasa de 1m)
Tiempo de Elección de Líderes (stddev)
Búsqueda de Seguimiento de Solicitudes de Red
Seguidor de búsqueda de solicitudes de red (tarifa de 15m)
Seguidor de búsqueda de solicitudes de red (tarifa de 5m)
Seguidor de recuperación de solicitudes de red (tasa media)
Seguidor de búsqueda de solicitudes de red (tarifa de 1m)
Mensajes de temas de broker
Mensajes de tema de broker (tarifa 15m)
Mensajes de tema de broker (tarifa 5m)
Mensajes de tema de broker (tasa media)
Mensajes de tema de broker (tarifa 1m)
Bytes de tema de broker en
Bytes de tema de broker (tasa 15m)
Bytes de tema de broker (tasa 5m)
Bytes de Tema de Broker en (Tasa Media)
Bytes de tema de broker (tasa 1m)
Recuento de Desconexiones de ZooKeeper
ZooKeeper desconexiones (tarifa de 15m)
ZooKeeper desconexiones (tarifa de 5m)
ZooKeeper se desconecta (tasa media)
ZooKeeper desconexiones (tarifa de 1m)
Tiempo total de recuperación de solicitudes de red para consumidores (percentil 50th)
Tiempo total de recuperación de solicitudes de red para consumidores (percentil 75th)
Tiempo total de recuperación de solicitudes de red para consumidores (percentil 95th)
Tiempo total de recuperación de solicitudes de red para consumidores (percentil 98th)
Tiempo total de recuperación de solicitudes de red para consumidores (percentil 999th)
Tiempo total de recuperación de solicitudes de red para consumidores (percentil 99th)
Tiempo Total de Recuperación de Solicitudes de Red de Consumidor
Solicitudes de red Recuperar máximo de tiempo total de consumidor
Solicitudes de red Recuperar media de tiempo total de consumidor
Solicitudes de Red: Recuperar Tiempo Total de Consumidor Mínimo
Solicitudes de Red Recuperar Tiempo Total de Consumidor STDDEV
Recuento de latiguillos
Solicitudes en espera en Fetch Purgatory
Bytes de Tema de Broker Fuera
Bytes de salida de tema de broker (tasa 15m)
Bytes de salida de tema de broker (tasa 5m)
Bytes de Salida de Tema de Broker (Tasa Media)
Bytes de salida de tema de broker (tasa 1m)
Autenticaciones de ZooKeeper
Autenticaciones ZooKeeper (tarifa de 15m)
Autenticaciones ZooKeeper (tarifa de 5m)
Autenticaciones de ZooKeeper (tasa media)
Autenticaciones ZooKeeper (tarifa de 1m)
Recuento de Solicitudes Producidas
Solicitudes Produce (tarifa de 15m)
Solicitudes Produce (tarifa de 5m)
Producción de Solicitudes (Tasa Media)
Solicitudes Produce (tarifa de 1m)
El gestor de réplicas ISR se expande
Replica Manager ISR expande (15m de velocidad)
Replica Manager ISR expande (5m de velocidad)
El gestor de réplicas ISR se expande (tasa media)
Replica Manager ISR expande (1m de velocidad)
Gestor de réplicas en Particiones replicadas 
|===


== Resolución de problemas

Puede encontrar información adicional en link:concept_requesting_support.html["Soporte técnico"] página.
